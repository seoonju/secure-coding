{% extends "base.html" %}
{% block title %}ëŒ€ì‹œë³´ë“œ{% endblock %}
{% block content %}
<h1>ğŸ“‹ ëŒ€ì‹œë³´ë“œ</h1>

<form method="GET" action="{{ url_for('dashboard') }}" style="margin-bottom: 20px;">
  <input type="text" name="q" placeholder="ìƒí’ˆëª… ë˜ëŠ” ì„¤ëª…, ìœ ì € ê²€ìƒ‰" value="{{ request.args.get('q', '') }}">
  <button type="submit">ê²€ìƒ‰</button>
</form>

<h3>ğŸ›’ ë“±ë¡ëœ ìƒí’ˆ</h3>
<ul>
  {% for product in products %}
    <li style="margin-bottom: 15px;">
      <a href="{{ url_for('view_product', product_id=product.id) }}"
         style="font-size: 1.2rem; font-weight: 700; text-decoration: none; ">
         {{ product.title }}
      </a><br>
      ğŸ’µ ê°€ê²©: <strong>{{ product.price }}</strong><br>
      ğŸ§‘â€ğŸ’¼ íŒë§¤ì: {{ product.username }}
    </li>
  {% endfor %}
</ul>
<p>
  <a href="{{ url_for('new_product') }}" 
     style="
       display: inline-block;
       padding: 10px 16px;
       border: 2px solid #007AFF;
       border-radius: 6px;
       text-decoration: none;
       color: #007AFF;
       font-weight: bold;
       background-color: #f0f8ff;
     ">
    â• ìƒˆ ìƒí’ˆ ë“±ë¡
  </a>
</p>

<br>
<h3>ğŸ’¬ ì‹¤ì‹œê°„ ì±„íŒ…</h3>
<div id="chat">
  <ul id="messages"></ul>
  <input id="chat_input" type="text" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
  <button onclick="sendMessage()">ì „ì†¡</button>
</div>

<script type="text/javascript">
  var socket = io();
  socket.on('connect', function() {
    console.log("ì±„íŒ… ì„œë²„ì— ì—°ê²°ë¨");
  });
  socket.on('message', function(data) {
    var messages = document.getElementById('messages');
    var item = document.createElement('li');
    item.textContent = data.username + ": " + data.message;
    messages.appendChild(item);
    window.scrollTo(0, document.body.scrollHeight);
  });
  function sendMessage() {
    var input = document.getElementById('chat_input');
    var message = input.value;
    if (message) {
      socket.emit('send_message', { 'username': "{{ user.username }}", 'message': message });
      input.value = "";
    }
  }
</script>
{% endblock %}
